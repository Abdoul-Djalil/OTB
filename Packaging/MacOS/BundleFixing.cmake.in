set(APP_LIST @OTB_APPS_NAME_LIST@)

foreach(APP ${APP_LIST})
  list(APPEND OTB_APPS_LIST_INSTALL ${CMAKE_INSTALL_PREFIX}/lib/otb/applications/${APP})
endforeach(APP)

include(BundleUtilities)
set(BU_CHMOD_BUNDLE_ITEMS ON)
set(DYLIB_SEARCH_DIRS)
list(APPEND DYLIB_SEARCH_DIRS @OTB_INSTALL_PREFIX@/lib)        #OTB dylib path
list(APPEND DYLIB_SEARCH_DIRS @ITK_INSTALL_PREFIX@/lib)        #ITK dylib path
list(APPEND DYLIB_SEARCH_DIRS @CMAKE_INSTALL_PREFIX@/lib/otb) #monteverdi2 dylib path
list(APPEND DYLIB_SEARCH_DIRS @CMAKE_INSTALL_PREFIX@/lib/qt4/plugins/sqldrivers) #Qtsqlite plugins

fixup_bundle(
  "${CMAKE_INSTALL_PREFIX}/bin/@EXE_FILENAME@"
  "${OTB_APPS_LIST_INSTALL};${CMAKE_INSTALL_PREFIX}/lib/qt4/plugins/sqldrivers/libqsqlite.dylib"
  "${DYLIB_SEARCH_DIRS}"
  )
