# CMake configuration
cmake_minimum_required(VERSION 2.8.9)
cmake_policy(SET CMP0046 NEW)

# Module
project(MPIConfig)
set(MPIConfig_LIBRARIES MPIConfig)

# Ctest configuration
set(INPUTDATA $ENV{OTB_DATA_ROOT})
if("x${INPUTDATA}" STREQUAL "x")
  message(WARNING, "Variable OTB_DATA_ROOT is not defined.")
else()
  if (NOT EXISTS ${INPUTDATA})
    message(WARNING, "Data test directory does not exist : ${INPUTDATA}")
  endif()
endif()
set(TEMP ${CMAKE_BINARY_DIR}/Testing/Temporary)
set(NOTOL      0.0)
set(EPSILON_1  0.1)
set(EPSILON_2  0.01)
set(EPSILON_3  0.001)
set(EPSILON_4  0.0001)
set(EPSILON_5  0.00001)
set(EPSILON_6  0.000001)
set(EPSILON_7  0.0000001)
set(EPSILON_8  0.00000001)
set(EPSILON_9  0.000000001)
set(EPSILON_10 0.0000000001)
set(EPSILON_11 0.00000000001)
set(EPSILON_12 0.000000000001)
set(EPSILON_13 0.0000000000001)
set(EPSILON_14 0.00000000000001)
set(EPSILON_15 0.000000000000001)

# OTB configuration
if(NOT OTB_SOURCE_DIR)
  find_package(OTB REQUIRED)
  set(OTB_SOURCE_DIR $ENV{OTB_SRC})
  if("x${OTB_SOURCE_DIR}" STREQUAL "x")
    message(FATAL_ERROR, "Variable OTB_SRC is not defined.")
  else()
    if (NOT EXISTS ${OTB_SOURCE_DIR})
      message(FATAL_ERROR, "OTB src directory does not exist : ${OTB_SOURCE_DIR}")
    endif()
  endif()
  set(OTB_CMAKE_DIR ${OTB_SOURCE_DIR}/CMake)
  list(APPEND CMAKE_MODULE_PATH ${OTB_CMAKE_DIR})
  include(OTBModuleExternal)
else()
  otb_module_impl()
endif()
